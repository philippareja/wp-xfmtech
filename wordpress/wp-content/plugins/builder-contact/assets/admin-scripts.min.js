var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,e,b){a instanceof String&&(a=String(a));for(var c=a.length,d=0;d<c;d++){var f=a[d];if(e.call(b,f,d,a))return{i:d,v:f}}return{i:-1,v:void 0}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,e,b){a!=Array.prototype&&a!=Object.prototype&&(a[e]=b.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};
$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,e,b,c){if(e){b=$jscomp.global;a=a.split(".");for(c=0;c<a.length-1;c++){var d=a[c];d in b||(b[d]={});b=b[d]}a=a[a.length-1];c=b[a];e=e(c);e!=c&&null!=e&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:e})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6-impl","es3");
(function(a){a(function(){var e=function(b){this.$table=a(b);this.init()};e.prototype={init:function(){this.loadExtraFields();this.loadOrders();this.makeSortable();this.events()},loadOrders:function(){var b=this,c=this.$table.find("tbody tr").sort(function(b,c){var d=a(b).find(".tb_lb_option").attr("id"),e=a(c).find(".tb_lb_option").attr("id"),d=void 0===d?a(b).find(".tb_new_field_textbox").val():d,e=void 0===e?a(c).find(".tb_new_field_textbox").val():e;try{var f=JSON.parse(a("#field_order").val())}catch(l){}f||
(f={});return f[d]-f[e]});a.each(c,function(a,c){b.$table.find("tbody").append(c)})},loadExtraFields:function(){var b=this,c=a(".tb_new_field_row");try{var d=JSON.parse(a("#field_extra").val())}catch(k){}d||(d={fields:[]});var e=a("#tmpl-builder-contact-new-field").length?a("#tmpl-builder-contact-new-field").html():a("#tb_site_canvas_iframe").contents().find("#tmpl-builder-contact-new-field").html();_.templateSettings={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g};
_.each(d.fields,function(f,h){var g=_.template(e,{variable:"data"});f.index=++h;d.id=b.$table.find(".tb_contact_new_row").length++;d.field=f;a(g(d)).insertBefore(c)})},events:function(){var b=this;this.$table.on("click",".tb_new_field_action",function(a){a.preventDefault();b.addField(this)}).on("change",'input[name*="tb_new_field_type_"]',function(){b.switchField(this)}).on("click",".tb_add_field_option",function(b){b.preventDefault();a(this).siblings("ul").append('<li><input type="text" class="tb_multi_option"><a href="#" class="tb_contact_value_remove"><i class="ti ti-close"></i></a></li>')}).on("change",
".tb_multi_option",function(){b.setNames()}).on("keyup",'.tb_contact_new_row input[type="text"], .tb_contact_new_row textarea',function(){b.changeObject()}).on("change",".tb_contact_new_row .tb_new_field_required",function(){b.changeObject()}).on("click",".tb_contact_value_remove",function(c){c.preventDefault();a(this).closest("li").remove();b.changeObject()}).on("click",".tb_contact_field_remove",function(c){c.preventDefault();a(this).closest("tr").remove();b.changeObject()});a("#field_message_active_field").prop("checked")||
a("#field_message_active_reverse").prop("checked",!0)},setNames:function(){this.$table.find(".tb_multi_option").each(function(b){var c=a(this).closest("tr").find(".tb_new_field_textbox").val(),c=c.toLowerCase(),c=c.replace(/ /g,"_");a(this).attr("name",c+"_"+b).attr("id",c+"_"+b)})},makeSortable:function(){var a=this;this.$table.find("tbody").sortable({items:"tr:not(.tb_new_field_row)",placeholder:"ui-state-highlight",update:function(){a.changeObject();a.sort()}}).disableSelection()},sort:function(){var b=
{};a(".contact_fields tr").each(function(){var c=a(this).find(".tb_lb_option").attr("id");c||(c=a(this).find(".tb_new_field_textbox").val());b[c]=a(this).index()});a("#field_order").val(JSON.stringify(b));Themify.triggerEvent(a("#field_order").get(0),"keyup")},addField:function(b){var c=a(b),d={};b=c.closest("tr");c=c.closest("tbody");var e=a("#tmpl-builder-contact-new-field").length?a("#tmpl-builder-contact-new-field").html():a("#tb_site_canvas_iframe").contents().find("#tmpl-builder-contact-new-field").html();
_.templateSettings={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g};e=_.template(e,{variable:"data"});d.id=c.find(".tb_contact_new_row").length++;d=a(e(d));d.insertBefore(b);d.find('input[name*="tb_new_field_type_"]:checked').trigger("keyup");c.sortable("refresh");this.changeObject()},switchField:function(b){var c=a(b).val();a(b).closest(".tb_new_field_type").next().find(".control-input").html(this.fieldUI(c));"static"===c?a(b).closest(".tb_new_field_type").next().find(".tb_new_field_required").parent().css("display",
"none"):a(b).closest(".tb_new_field_type").next().find(".tb_new_field_required").parent().css("display","")},fieldUI:function(b,c){switch(b){case "text":case "textarea":var d=a('<input type="text" placeholder="Placeholder" class="tb_new_field_value tb_field_type_'+b+'">');break;case "static":d=a('<textarea placeholder="Enter text or HTML here" class="tb_new_field_value tb_field_type_'+b+'"></textarea>');break;case "radio":case "select":case "checkbox":d=a("#tmpl-builder-contact-new-field-options").length?
a("#tmpl-builder-contact-new-field-options").html():a("#tb_site_canvas_iframe").contents().find("#tmpl-builder-contact-new-field-options").html(),_.templateSettings={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g},d=_.template(d,{variable:"data"}),c||(c={type:b,fields:[""]}),d=a(d(c))}this.changeObject();return d},changeObject:function(){var b={fields:[]};this.$table.find(".tb_contact_new_row").each(function(){var c=a(this),d=c.find('input[name*="tb_new_field_type_"]:checked').val(),
e=c.index(),k=c.find(".tb_new_field_textbox").val(),h=c.find(".tb_new_field_required").is(":checked");switch(d){case "text":case "textarea":case "static":var g=c.find(".tb_new_field_value").val();break;case "radio":case "select":case "checkbox":g=[],c.find(".tb_multi_option").each(function(){g.push(a(this).val())})}b.fields.push({order:e,type:d,label:k,value:g,required:h})});this.$table.find("#field_extra").val(JSON.stringify(b));Themify.triggerEvent(this.$table.find("#field_extra").get(0),"keyup");
this.sort()}};a("body").on("editing_module_option",function(){setTimeout(function(){new e(".contact_fields");a("#field_message_active_reverse").on("click",function(){a("#field_message_active_field").trigger("click")})},10)})})})(jQuery);
