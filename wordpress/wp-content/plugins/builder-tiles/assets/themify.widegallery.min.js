(function(a,n,p,r){function h(b,c){this.element=b;this.options=a.extend({},l,c);this._defaults=l;this.init()}var l={info:".twg-info",terms:".twg-terms",title:".twg-title",date:".twg-date",primaryAction:".twg-primary-action",actions:".twg-actions",speed:300,event:"click",ajax_url:"",ajax_action:"themify_get_gallery_entry",networkError:"",termSeparator:"",loader:'<div class="themify-loader"><div class="themify-loader_1 themify-loader_blockG"></div><div class="themify-loader_2 themify-loader_blockG"></div><div class="themify-loader_3 themify-loader_blockG"></div></div>'};
h.prototype={init:function(){a(this.element).hasClass("twg-gallery-shortcode")?this.galleryShortcode():this.galleryPostType();var b=this;a(n).on("tfsmartresize",function(){b.doneResizing(a(b.element))}).on("orientationchange",function(){b.doneResizing(a(b.element))})},galleryPostType:function(){var b=this,c=a(this.element),d=a(".twg-controls",this.element),e=a(".twg-loading",this.element);a("<img />").on("load",function(){var f=a(".twg-link:first-child",d);e.html("").fadeOut();"undefined"!==typeof a.fn.backstretch?
(c.backstretch(a(this).attr("src")),a(".backstretch",c).addClass("twg-deleteable").hide().fadeIn()):a(this).addClass("twg-deleteable").hide().prependTo(c).fadeIn();b.displayEntry(f.data("entry_id"))}).prop("src",a(".twg-link:first-child",d).data("image"));d.on(b.options.event,".twg-link",function(c){c.preventDefault();b.initEntryDisplay(a(this))})},initEntryDisplay:function(b){var c=this,d=a(this.element),e=a(".twg-loading",this.element),f=b.data("image"),k=a("<img />");e.html(c.options.loader).fadeIn();
k.on("load",function(){"undefined"!==typeof a.fn.backstretch?(d.backstretch(a(this).attr("src")),a(".backstretch",d).addClass("twg-behind")):a(this).addClass("twg-behind").prependTo(d);a(".twg-deleteable",d).fadeOut(c.options.speed,function(){a(".twg-behind",d).addClass("twg-deleteable").removeClass("twg-behind");a(this).remove();e.html("").fadeOut()});c.displayEntry(b.data("entry_id"))}).attr("src",f)},displayEntry:function(b){var c=this,d=a(this.options.info,c.element),e=a(this.options.terms,c.element),
f=a(this.options.title,c.element),k=a(this.options.date,c.element),q=a(this.options.primaryAction,c.element),h=a(this.options.actions,c.element),m=a(".twg-caption",this.element);d.fadeOut(c.options.speed);a.post(c.options.ajax_url,{action:c.options.ajax_action,entry_id:b},function(b,l){if("success"!==l)m.text(c.options.networkError).wrapInner('<div class="text-caption" />');else{var g=jQuery.parseJSON(b);e.empty();a.each(g.terms,function(b,d){a('<a href="'+d.link+'">'+d.name+"</a>").appendTo(e);a('<span class="separator">'+
c.options.termSeparator+"</span>").appendTo(e)});f.text(g.title).attr("href",g.link);k.text(g.date);m.html(g.excerpt);""!=g.excerpt&&m.wrapInner('<div class="text-caption" />');q.attr("href",g.link);h.fadeIn();d.fadeIn(c.options.speed)}})},galleryShortcode:function(){var b=this,c=a(this.element),d=a(".twg-caption",this.element),e=a(".twg-controls",this.element),f=a(".twg-loading",this.element);a("<img />").on("load",function(){f.html("").fadeOut();"undefined"!==typeof a.fn.backstretch?(c.backstretch(a(this).attr("src")),
a(".backstretch",c).addClass("twg-deleteable").hide().fadeIn(b.options.speed,function(){d.text(a(".twg-link:first-child",e).data("description"));""!=d.text()&&d.wrapInner('<div class="text-caption" />')})):a(this).addClass("twg-deleteable").hide().prependTo(c).fadeIn(b.options.speed,function(){d.text(a(".twg-link:first-child",e).data("description"));""!=d.text()&&d.wrapInner('<div class="text-caption" />')})}).attr("src",a(".twg-link:first-child",e).data("image"));e.on(b.options.event,".twg-link",
function(c){c.preventDefault();b.initImageDisplay(a(this))})},initImageDisplay:function(b){var c=this,d=a(this.element),e=a(".twg-caption",this.element),f=a(".twg-loading",this.element),k=b.data("image"),h=a("<img />");f.html(c.options.loader).fadeIn();h.on("load",function(){"undefined"!==typeof a.fn.backstretch?(d.backstretch(a(this).attr("src")),a(".backstretch",d).addClass("twg-behind")):a(this).addClass("twg-behind").prependTo(d);a(".twg-deleteable",d).fadeOut(c.options.speed,function(){a(".twg-behind",
d).addClass("twg-deleteable").removeClass("twg-behind");a(this).remove();f.html("").fadeOut()});e.fadeOut(c.options.speed,function(){a(this).text(b.data("description")).fadeIn();""!=a(this).text()&&e.wrapInner('<div class="text-caption" />')})}).attr("src",k)},doneResizing:function(b){"undefined"!==typeof a.fn.backstretch&&(b=b.data("backstretch"),"undefined"!==typeof b&&b.resize())},isTouchDevice:function(){try{return p.createEvent("TouchEvent"),!0}catch(b){return!1}}};a.fn.ThemifyWideGallery=function(b){return this.each(function(){var c=
a.data(this,"ThemifyWideGallery");c||a.data(this,"ThemifyWideGallery",new h(this,b));if("undefined"!==typeof b.method&&"function"===typeof c[b.method])if("undefined"!==typeof b.element)c[b.method](b.element);else c[b.method]()})}})(jQuery,window,document);
